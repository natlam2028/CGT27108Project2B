<!-- FILE: styles.css -->
function updateNavCounts(){
const cart=getCart();
const count=Object.values(cart).reduce((a,b)=>a+b,0);
document.querySelectorAll('#nav-cart-count, #nav-cart-count-2, #nav-cart-count-3').forEach(el=>{el.textContent=count});
}


// Small toast for feedback
function showToast(msg){
const t = document.createElement('div');
t.className='toast align-items-center text-bg-dark border-0 position-fixed bottom-0 end-0 m-3';
t.innerHTML=`<div class="d-flex"><div class="toast-body">${msg}</div><button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button></div>`;
document.body.appendChild(t);
const bs = new bootstrap.Toast(t,{delay:1200});
bs.show();
t.addEventListener('hidden.bs.toast',()=>t.remove());
}


// Rendering utilities
function el(html){const d=document.createElement('div');d.innerHTML=html.trim();return d.firstChild}


// Product list rendering (for home & products page)
function renderProductCard(p){
return `<div class="col-sm-6 col-md-4">
<div class="card product-card p-3 h-100">
<img src="${p.img}" class="prod-img mx-auto d-block" alt="${p.name}">
<div class="card-body d-flex flex-column">
<h5 class="card-title">${p.name}</h5>
<p class="text-muted mb-2 small">${p.country} • ${p.category}</p>
<div class="mt-auto d-flex justify-content-between align-items-center">
<div>
<strong>$${p.price.toFixed(2)}</strong>
</div>
<div class="d-flex gap-2 align-items-center">
<input type="number" min="1" value="1" data-id="${p.id}" class="form-control form-control-sm qty-input" style="width:70px;">
<button class="btn btn-sm btn-primary add-cart" data-id="${p.id}">Add</button>
</div>
</div>
</div>
</div>
</div>`;
}


function populateHome(){
const elHome = document.getElementById('home-products');
if(!elHome) return;
const picks = PRODUCTS.slice(0,4);
elHome.innerHTML = picks.map(renderProductCard).join('');
}


function populateProducts(){
const list = document.getElementById('product-list');
if(!list) return;
const countrySel = document.getElementById('filter-country');
const cats = [...new Set(PRODUCTS.map(p=>p.country))];
countrySel.innerHTML = '<option value="all">All countries</option>' + cats.map(c=>`<option>${c}</option>`).join('');
applyFilters();
}


function applyFilters(){
const list = document.getElementById('product-list');
if(!list) return;
const country=document.getElementById('filter-country').value;
const cat=document.getElementById('filter-category').value;
const min=document.getElementById('price-min').value;
const max=document.getElementById('price-max').value;
let out = PRODUCTS.filter(p=>{
if(country!=='all' && p.country!==country) return false;
if(cat!=='all' && p.category!==cat) return false;
if(min && p.price < Number(min)) return false;
if(max && p.price > Number(max)) return false;
return true;
});
document.getElementById('result-count').textContent = out.length;
list.innerHTML = out.map(renderProductCard).join('');
}


function populateProductDetail(){
const el = document.getElementById('product-detail');
if(!el) return;
const params = new URLSearchParams(location.search);
const id = Number(params.get('id'))||1;
const p = PRODUCTS.find(x=>x.id===id) || PRODUCTS[0];
el.innerHTML = `
<div class="col-md-5">
<img src="${p.img}" class="img-fluid rounded" alt="${p.name}">
</div>
<div class="col-md-7">
<h3>${p.name}</h3>
<p class="text-muted">${p.country} • ${p.category}</p>
<h4 class="mt-3 mb-3">$${p.price.toFixed(2)}</h4>
<p>${p.desc}</p>
<div class="d-flex gap-2 mt-3">
<input id="pd-qty" type="number" min="1" value="1" class="form-control" style="width:100px;">
<button id="pd-add" class="btn btn-primary">Add to cart</button>
<a href="cart.html" class="btn btn-outline-secondary">View cart</a>
window.PRODUCTS = PRODUCTS;